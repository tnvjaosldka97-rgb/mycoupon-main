import { drizzle } from 'drizzle-orm/mysql2';
import mysql from 'mysql2/promise';
import * as schema from './drizzle/schema.js';

const connection = await mysql.createConnection(process.env.DATABASE_URL);
const db = drizzle(connection, { schema, mode: 'default' });

// 강남 지역 가게 데이터
const gangnamStores = [
  {
    name: '강남 스타벅스',
    category: '카페',
    address: '서울 강남구 강남대로 396',
    latitude: 37.4979,
    longitude: 127.0276,
    phone: '02-538-5000',
    description: '강남역 근처 대형 스타벅스',
    openingHours: '07:00-22:00',
    imageUrl: '/stores/gangnam-starbucks.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '강남 맥도날드',
    category: '패스트푸드',
    address: '서울 강남구 강남대로 지하 396',
    latitude: 37.4980,
    longitude: 127.0278,
    phone: '02-567-1234',
    description: '24시간 운영 맥도날드',
    openingHours: '24시간',
    imageUrl: '/stores/gangnam-mcdonalds.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '강남 CGV',
    category: '영화관',
    address: '서울 강남구 강남대로 438',
    latitude: 37.4990,
    longitude: 127.0280,
    phone: '1544-1122',
    description: '강남 최대 규모 영화관',
    openingHours: '10:00-24:00',
    imageUrl: '/stores/gangnam-cgv.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '강남 교보문고',
    category: '서점',
    address: '서울 강남구 강남대로 465',
    latitude: 37.5000,
    longitude: 127.0282,
    phone: '02-6002-6002',
    description: '대형 서점 및 문화공간',
    openingHours: '09:30-22:00',
    imageUrl: '/stores/gangnam-kyobo.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '강남 올리브영',
    category: '화장품',
    address: '서울 강남구 강남대로 422',
    latitude: 37.4985,
    longitude: 127.0275,
    phone: '02-567-5678',
    description: '대형 화장품 전문점',
    openingHours: '10:00-23:00',
    imageUrl: '/stores/gangnam-oliveyoung.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '강남 롯데리아',
    category: '패스트푸드',
    address: '서울 강남구 강남대로 410',
    latitude: 37.4975,
    longitude: 127.0270,
    phone: '02-567-8901',
    description: '한국형 패스트푸드',
    openingHours: '07:00-23:00',
    imageUrl: '/stores/gangnam-lotteria.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '강남 투썸플레이스',
    category: '카페',
    address: '서울 강남구 강남대로 428',
    latitude: 37.4988,
    longitude: 127.0277,
    phone: '02-567-2345',
    description: '디저트 카페',
    openingHours: '08:00-22:00',
    imageUrl: '/stores/gangnam-twosome.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '강남 GS25',
    category: '편의점',
    address: '서울 강남구 강남대로 400',
    latitude: 37.4970,
    longitude: 127.0268,
    phone: '02-567-3456',
    description: '24시간 편의점',
    openingHours: '24시간',
    imageUrl: '/stores/gangnam-gs25.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '강남 파리바게뜨',
    category: '베이커리',
    address: '서울 강남구 강남대로 415',
    latitude: 37.4978,
    longitude: 127.0273,
    phone: '02-567-4567',
    description: '프랑스식 베이커리',
    openingHours: '07:00-23:00',
    imageUrl: '/stores/gangnam-paris.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '강남 BBQ',
    category: '치킨',
    address: '서울 강남구 강남대로 405',
    latitude: 37.4973,
    longitude: 127.0271,
    phone: '02-567-5678',
    description: '프리미엄 치킨 전문점',
    openingHours: '11:00-24:00',
    imageUrl: '/stores/gangnam-bbq.jpg',
    isActive: true,
    ownerId: 1,
  },
];

// 홍대 지역 가게 데이터
const hongdaeStores = [
  {
    name: '홍대 스타벅스',
    category: '카페',
    address: '서울 마포구 양화로 160',
    latitude: 37.5563,
    longitude: 126.9234,
    phone: '02-333-5000',
    description: '홍대입구역 근처 스타벅스',
    openingHours: '07:00-23:00',
    imageUrl: '/stores/hongdae-starbucks.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '홍대 CGV',
    category: '영화관',
    address: '서울 마포구 양화로 153',
    latitude: 37.5565,
    longitude: 126.9236,
    phone: '1544-1122',
    description: '홍대 메인 영화관',
    openingHours: '10:00-24:00',
    imageUrl: '/stores/hongdae-cgv.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '홍대 교보문고',
    category: '서점',
    address: '서울 마포구 양화로 188',
    latitude: 37.5570,
    longitude: 126.9238,
    phone: '02-6002-6002',
    description: '홍대 문화공간',
    openingHours: '10:00-22:00',
    imageUrl: '/stores/hongdae-kyobo.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '홍대 올리브영',
    category: '화장품',
    address: '서울 마포구 양화로 145',
    latitude: 37.5560,
    longitude: 126.9230,
    phone: '02-333-5678',
    description: '홍대 화장품 매장',
    openingHours: '10:00-23:00',
    imageUrl: '/stores/hongdae-oliveyoung.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '홍대 맥도날드',
    category: '패스트푸드',
    address: '서울 마포구 양화로 150',
    latitude: 37.5562,
    longitude: 126.9232,
    phone: '02-333-1234',
    description: '24시간 운영',
    openingHours: '24시간',
    imageUrl: '/stores/hongdae-mcdonalds.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '홍대 투썸플레이스',
    category: '카페',
    address: '서울 마포구 양화로 165',
    latitude: 37.5567,
    longitude: 126.9235,
    phone: '02-333-2345',
    description: '디저트 카페',
    openingHours: '08:00-23:00',
    imageUrl: '/stores/hongdae-twosome.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '홍대 CU',
    category: '편의점',
    address: '서울 마포구 양화로 140',
    latitude: 37.5558,
    longitude: 126.9228,
    phone: '02-333-3456',
    description: '24시간 편의점',
    openingHours: '24시간',
    imageUrl: '/stores/hongdae-cu.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '홍대 파리바게뜨',
    category: '베이커리',
    address: '서울 마포구 양화로 155',
    latitude: 37.5564,
    longitude: 126.9233,
    phone: '02-333-4567',
    description: '베이커리 카페',
    openingHours: '07:00-23:00',
    imageUrl: '/stores/hongdae-paris.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '홍대 BBQ',
    category: '치킨',
    address: '서울 마포구 양화로 170',
    latitude: 37.5568,
    longitude: 126.9237,
    phone: '02-333-5678',
    description: '치킨 전문점',
    openingHours: '11:00-24:00',
    imageUrl: '/stores/hongdae-bbq.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '홍대 롯데리아',
    category: '패스트푸드',
    address: '서울 마포구 양화로 175',
    latitude: 37.5569,
    longitude: 126.9239,
    phone: '02-333-6789',
    description: '한국형 패스트푸드',
    openingHours: '07:00-23:00',
    imageUrl: '/stores/hongdae-lotteria.jpg',
    isActive: true,
    ownerId: 1,
  },
];

// 이태원 지역 가게 데이터
const itaewonStores = [
  {
    name: '이태원 스타벅스',
    category: '카페',
    address: '서울 용산구 이태원로 200',
    latitude: 37.5345,
    longitude: 126.9945,
    phone: '02-749-5000',
    description: '이태원역 근처 스타벅스',
    openingHours: '07:00-23:00',
    imageUrl: '/stores/itaewon-starbucks.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '이태원 맥도날드',
    category: '패스트푸드',
    address: '서울 용산구 이태원로 210',
    latitude: 37.5347,
    longitude: 126.9947,
    phone: '02-749-1234',
    description: '24시간 운영',
    openingHours: '24시간',
    imageUrl: '/stores/itaewon-mcdonalds.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '이태원 CGV',
    category: '영화관',
    address: '서울 용산구 이태원로 220',
    latitude: 37.5350,
    longitude: 126.9950,
    phone: '1544-1122',
    description: '이태원 영화관',
    openingHours: '10:00-24:00',
    imageUrl: '/stores/itaewon-cgv.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '이태원 올리브영',
    category: '화장품',
    address: '서울 용산구 이태원로 195',
    latitude: 37.5343,
    longitude: 126.9943,
    phone: '02-749-5678',
    description: '화장품 전문점',
    openingHours: '10:00-23:00',
    imageUrl: '/stores/itaewon-oliveyoung.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '이태원 투썸플레이스',
    category: '카페',
    address: '서울 용산구 이태원로 205',
    latitude: 37.5346,
    longitude: 126.9946,
    phone: '02-749-2345',
    description: '디저트 카페',
    openingHours: '08:00-23:00',
    imageUrl: '/stores/itaewon-twosome.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '이태원 GS25',
    category: '편의점',
    address: '서울 용산구 이태원로 190',
    latitude: 37.5342,
    longitude: 126.9942,
    phone: '02-749-3456',
    description: '24시간 편의점',
    openingHours: '24시간',
    imageUrl: '/stores/itaewon-gs25.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '이태원 파리바게뜨',
    category: '베이커리',
    address: '서울 용산구 이태원로 215',
    latitude: 37.5348,
    longitude: 126.9948,
    phone: '02-749-4567',
    description: '베이커리 카페',
    openingHours: '07:00-23:00',
    imageUrl: '/stores/itaewon-paris.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '이태원 BBQ',
    category: '치킨',
    address: '서울 용산구 이태원로 225',
    latitude: 37.5351,
    longitude: 126.9951,
    phone: '02-749-5678',
    description: '치킨 전문점',
    openingHours: '11:00-24:00',
    imageUrl: '/stores/itaewon-bbq.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '이태원 롯데리아',
    category: '패스트푸드',
    address: '서울 용산구 이태원로 230',
    latitude: 37.5352,
    longitude: 126.9952,
    phone: '02-749-6789',
    description: '한국형 패스트푸드',
    openingHours: '07:00-23:00',
    imageUrl: '/stores/itaewon-lotteria.jpg',
    isActive: true,
    ownerId: 1,
  },
  {
    name: '이태원 CU',
    category: '편의점',
    address: '서울 용산구 이태원로 185',
    latitude: 37.5341,
    longitude: 126.9941,
    phone: '02-749-7890',
    description: '24시간 편의점',
    openingHours: '24시간',
    imageUrl: '/stores/itaewon-cu.jpg',
    isActive: true,
    ownerId: 1,
  },
];

// 모든 가게 데이터 삽입
const allStores = [...gangnamStores, ...hongdaeStores, ...itaewonStores];

console.log(`총 ${allStores.length}개의 가게 데이터를 추가합니다...`);

for (const store of allStores) {
  const [result] = await db.insert(schema.stores).values(store);
  const storeId = result.insertId;
  
  // 각 가게마다 2-3개의 쿠폰 생성
  const coupons = [
    {
      storeId,
      title: `${store.name} 10% 할인`,
      description: '전 메뉴 10% 할인 쿠폰',
      discountType: 'percentage',
      discountValue: 10,
      minPurchase: 10000,
      maxDiscount: 5000,
      totalQuantity: 100,
      remainingQuantity: 100,
      startDate: new Date(),
      endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), // 30일 후
      isActive: true,
    },
    {
      storeId,
      title: `${store.name} 3,000원 할인`,
      description: '3만원 이상 구매 시 3,000원 할인',
      discountType: 'fixed',
      discountValue: 3000,
      minPurchase: 30000,
      maxDiscount: 3000,
      totalQuantity: 50,
      remainingQuantity: 50,
      startDate: new Date(),
      endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),
      isActive: true,
    },
  ];
  
  for (const coupon of coupons) {
    await db.insert(schema.coupons).values(coupon);
  }
  
  console.log(`✓ ${store.name} 및 쿠폰 추가 완료`);
}

console.log('✅ 모든 가게 데이터 추가 완료!');
await connection.end();
